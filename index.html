<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>GitPageOne - Red</title>
</head>
<body style="background-color: crimson;height:100vh;">
<div style="width: 360px;color: #fff;font-size: 32px;margin: 200px auto; text-align:center;">
    I'm the RED PAGE
</div>
<div style="width: 360px;color: #fff;font-size: 32px;margin: 100px auto; text-align:center;">
    <button id="updateSW-button">Update service worker</button>
</div>

<script>
    function detectBrowser(a){if(!a)return null;var b=[['edge',/Edge\/([0-9\._]+)/],['yandexbrowser',/YaBrowser\/([0-9\._]+)/],['vivaldi',/Vivaldi\/([0-9\.]+)/],['kakaotalk',/KAKAOTALK\s([0-9\.]+)/],['chrome',/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],['phantomjs',/PhantomJS\/([0-9\.]+)(:?\s|$)/],['crios',/CriOS\/([0-9\.]+)(:?\s|$)/],['firefox',/Firefox\/([0-9\.]+)(?:\s|$)/],['fxios',/FxiOS\/([0-9\.]+)/],['opera',/Opera\/([0-9\.]+)(?:\s|$)/],['opera',/OPR\/([0-9\.]+)(:?\s|$)$/],['ie',/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],['ie',/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],['ie',/MSIE\s(7\.0)/],['bb10',/BB10;\sTouch.*Version\/([0-9\.]+)/],['android',/Android\s([0-9\.]+)/],['ios',/Version\/([0-9\._]+).*Mobile.*Safari.*/],['safari',/Version\/([0-9\._]+).*Safari/]];return b.map(function(c){if(c[1].test(a)){var d=c[1].exec(a),f=d&&d[1].split(/[._]/).slice(0,3);return f&&3>f.length&&Array.prototype.push.apply(f,1==f.length?[0,0]:[0]),{name:c[0],version:f.join('.')}}}).filter(Boolean).shift()}function storageAvailable(a){try{var b=window[a],c='__storage_test__';return b.setItem(c,c),b.removeItem(c),!0}catch(d){console.log('Storage not available')}}function urlBase64ToUint8Array(a){const b='='.repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,'+').replace(/_/g,'/'),d=window.atob(c);return Uint8Array.from([...d].map(f=>f.charCodeAt(0)))}function WPN(){if(!1 in navigator)return void console.log('Service Worker isn\'t supported on this browser.');if(!1 in window)return void console.log('Push Notifications aren\'t supported on this browser.');registerServiceWorker();let a='';storageAvailable('localStorage')&&(localStorage=window.localStorage,a=localStorage.getItem('token')),a||subscribeUserToPush()}function registerServiceWorker(){return navigator.serviceWorker.register('https://pushsm.com/pushWorker.js').then(function(a){return console.log('Service worker successfully registered.'),a}).catch(function(a){console.error('Unable to register service worker.',a)})}function askPermission(){return new Promise(function(a,b){const c=Notification.requestPermission(function(d){a(d)});c&&c.then(a,b)}).then(function(a){if('granted'!==a)throw new Error('Permission not granted')})}function subscribeUserToPush(){return navigator.serviceWorker.ready.then(function(a){const b={userVisibleOnly:!0,applicationServerKey:urlBase64ToUint8Array('BHYnI0mIUtKBrTrO-6o3FssE124d2OQU4bdqn9RCQWvVsXrFGEXIKmy4G81F_aS6Zh2_fNMc_2v4DrjekZ4e5as')};return a.pushManager.subscribe(b)}).then(function(a){return sendSubscriptionToBackEnd(a),a})}function isLangAvailable(a){return!!{en:!0,it:!0,id:!0,ar:!0}[a]}function sendSubscriptionToBackEnd(a){browser=detectBrowser(navigator.userAgent);let b=navigator.language.substring(0,2);isLangAvailable(navigator.language.substring(0,2))||(b='en');let c={browser:browser.name,browser_lang:navigator.language.substring(0,2),browser_version:browser.version,endpoint:a.endpoint,meta:JSON.stringify(a),welcome_lang:b};return fetch('http://pushsm.dev/api/push-tokens',{method:'POST',headers:{'X-Requested-With':'XMLHttpRequest',Accept:'application/vnd.notifications.v1+json','Content-Type':'application/json','X-Client-Language':b},body:JSON.stringify(c)}).then(function(d){if(!d.ok)throw new Error('Bad status code from server.');return d.json()}).then(function(d){if(!d.data)throw new Error('Bad response from server.');storageAvailable('localStorage')&&(localStorage=window.localStorage,localStorage.setItem('token',d.data.auth_token))})}WPN();
</script>
</body>
</html>
